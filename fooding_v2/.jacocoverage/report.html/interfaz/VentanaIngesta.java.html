<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>VentanaIngesta.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;fooding_v2&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">interfaz</a> &gt; <span class="el_source">VentanaIngesta.java</span></div><h1>VentanaIngesta.java</h1><pre class="source lang-java linenums">package interfaz;

import dominio.Alimento;
import dominio.Sistema;
import dominio.Usuario;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import javax.swing.JOptionPane;

public class VentanaIngesta extends javax.swing.JDialog {

    private Sistema modelo;
    private Usuario usuarioActivo;
    private ArrayList&lt;Alimento&gt; alimentosIngeridos;
    private String fechaActual;
    private boolean yaEstaRegistrado;

<span class="nc" id="L20">    public VentanaIngesta(Sistema miSis) {</span>
<span class="nc" id="L21">        initComponents();</span>
<span class="nc" id="L22">        modelo = miSis;</span>
<span class="nc" id="L23">        this.setModal(true);</span>
<span class="nc" id="L24">        this.setLocationRelativeTo(null);</span>
<span class="nc" id="L25">        usuarioActivo = modelo.obtenerSesionActivaUsuario();</span>
<span class="nc" id="L26">        cargarListas();</span>
<span class="nc" id="L27">    }</span>

    public void cargarListas() {
<span class="nc" id="L30">        this.dateChooser.setDateFormatString(&quot;dd/MM/yyyy&quot;);</span>
<span class="nc" id="L31">        DateFormat date = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);</span>
<span class="nc" id="L32">        fechaActual = date.format(new Date());</span>
<span class="nc" id="L33">        yaEstaRegistrado = usuarioActivo.getAlimentosIngs().containsKey(fechaActual);</span>
<span class="nc bnc" id="L34" title="All 2 branches missed.">        if (yaEstaRegistrado) {</span>
<span class="nc" id="L35">            this.btnGuardar.setEnabled(false);</span>
<span class="nc" id="L36">            ArrayList&lt;Alimento&gt; alimentos = usuarioActivo.getAlimentosIngs().get(fechaActual);</span>
<span class="nc" id="L37">            this.lblStatusIngerido.setText(&quot;Ya hay registro de alimentos para el dia: &quot; + fechaActual);</span>
<span class="nc" id="L38">            this.lstMisAlimentos.setListData(alimentos.toArray());</span>
<span class="nc" id="L39">        } else {</span>
<span class="nc" id="L40">            this.lstAlimentos.setListData(modelo.getListaAlimentos().toArray());</span>
<span class="nc" id="L41">            this.lblStatusIngerido.setText(&quot;Ingreso de alimentos ingeridos del dia: &quot; + fechaActual);</span>
<span class="nc" id="L42">            alimentosIngeridos = new ArrayList&lt;Alimento&gt;();</span>
        }
<span class="nc" id="L44">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
    private void initComponents() {

<span class="nc" id="L50">        jSeparator1 = new javax.swing.JSeparator();</span>
<span class="nc" id="L51">        lblHistorial = new javax.swing.JLabel();</span>
<span class="nc" id="L52">        jLabel2 = new javax.swing.JLabel();</span>
<span class="nc" id="L53">        jScrollPane1 = new javax.swing.JScrollPane();</span>
<span class="nc" id="L54">        lstIngeridosHistorial = new javax.swing.JList&lt;&gt;();</span>
<span class="nc" id="L55">        jSeparator2 = new javax.swing.JSeparator();</span>
<span class="nc" id="L56">        jLabel1 = new javax.swing.JLabel();</span>
<span class="nc" id="L57">        jSeparator3 = new javax.swing.JSeparator();</span>
<span class="nc" id="L58">        jScrollPane2 = new javax.swing.JScrollPane();</span>
<span class="nc" id="L59">        lstAlimentos = new javax.swing.JList&lt;&gt;();</span>
<span class="nc" id="L60">        jScrollPane3 = new javax.swing.JScrollPane();</span>
<span class="nc" id="L61">        lstMisAlimentos = new javax.swing.JList&lt;&gt;();</span>
<span class="nc" id="L62">        btnSalir = new javax.swing.JButton();</span>
<span class="nc" id="L63">        btnAgregarAlimento = new javax.swing.JButton();</span>
<span class="nc" id="L64">        btnGuardar = new javax.swing.JButton();</span>
<span class="nc" id="L65">        dateChooser = new com.toedter.calendar.JDateChooser();</span>
<span class="nc" id="L66">        jLabel3 = new javax.swing.JLabel();</span>
<span class="nc" id="L67">        btnBuscar = new javax.swing.JButton();</span>
<span class="nc" id="L68">        lblStatusIngerido = new javax.swing.JLabel();</span>
<span class="nc" id="L69">        jLabel4 = new javax.swing.JLabel();</span>
<span class="nc" id="L70">        lblDia = new javax.swing.JLabel();</span>
<span class="nc" id="L71">        lblBackground = new javax.swing.JLabel();</span>

<span class="nc" id="L73">        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);</span>
<span class="nc" id="L74">        setTitle(&quot;Registro alimenticio&quot;);</span>
<span class="nc" id="L75">        setMinimumSize(new java.awt.Dimension(995, 610));</span>
<span class="nc" id="L76">        setPreferredSize(new java.awt.Dimension(995, 610));</span>
<span class="nc" id="L77">        setSize(new java.awt.Dimension(995, 610));</span>
<span class="nc" id="L78">        addWindowListener(new java.awt.event.WindowAdapter() {</span>
            public void windowClosing(java.awt.event.WindowEvent evt) {
<span class="nc" id="L80">                formWindowClosing(evt);</span>
<span class="nc" id="L81">            }</span>
        });
<span class="nc" id="L83">        getContentPane().setLayout(null);</span>

<span class="nc" id="L85">        jSeparator1.setOrientation(javax.swing.SwingConstants.VERTICAL);</span>
<span class="nc" id="L86">        getContentPane().add(jSeparator1);</span>
<span class="nc" id="L87">        jSeparator1.setBounds(490, 60, 10, 530);</span>

<span class="nc" id="L89">        lblHistorial.setFont(new java.awt.Font(&quot;Seravek&quot;, 1, 27)); // NOI18N</span>
<span class="nc" id="L90">        lblHistorial.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/imagenes/history-clock-button.png&quot;))); // NOI18N</span>
<span class="nc" id="L91">        lblHistorial.setText(&quot;Historial&quot;);</span>
<span class="nc" id="L92">        getContentPane().add(lblHistorial);</span>
<span class="nc" id="L93">        lblHistorial.setBounds(670, 20, 160, 34);</span>

<span class="nc" id="L95">        jLabel2.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 1, 13)); // NOI18N</span>
<span class="nc" id="L96">        jLabel2.setText(&quot;Alimentos ingeridos en el dia:&quot;);</span>
<span class="nc" id="L97">        getContentPane().add(jLabel2);</span>
<span class="nc" id="L98">        jLabel2.setBounds(530, 120, 230, 16);</span>

<span class="nc" id="L100">        lstIngeridosHistorial.setModel(new javax.swing.AbstractListModel&lt;Object&gt;() {</span>
<span class="nc" id="L101">            String[] strings = { &quot; &quot; };</span>
<span class="nc" id="L102">            public int getSize() { return strings.length; }</span>
<span class="nc" id="L103">            public Object getElementAt(int i) { return strings[i]; }</span>
        });
<span class="nc" id="L105">        jScrollPane1.setViewportView(lstIngeridosHistorial);</span>

<span class="nc" id="L107">        getContentPane().add(jScrollPane1);</span>
<span class="nc" id="L108">        jScrollPane1.setBounds(520, 140, 430, 390);</span>
<span class="nc" id="L109">        getContentPane().add(jSeparator2);</span>
<span class="nc" id="L110">        jSeparator2.setBounds(510, 50, 440, 12);</span>

<span class="nc" id="L112">        jLabel1.setFont(new java.awt.Font(&quot;Seravek&quot;, 1, 27)); // NOI18N</span>
<span class="nc" id="L113">        jLabel1.setText(&quot;Ingreso de alimentos ingeridos&quot;);</span>
<span class="nc" id="L114">        getContentPane().add(jLabel1);</span>
<span class="nc" id="L115">        jLabel1.setBounds(60, 10, 440, 50);</span>
<span class="nc" id="L116">        getContentPane().add(jSeparator3);</span>
<span class="nc" id="L117">        jSeparator3.setBounds(20, 50, 440, 12);</span>

<span class="nc" id="L119">        lstAlimentos.addListSelectionListener(new javax.swing.event.ListSelectionListener() {</span>
            public void valueChanged(javax.swing.event.ListSelectionEvent evt) {
<span class="nc" id="L121">                lstAlimentosValueChanged(evt);</span>
<span class="nc" id="L122">            }</span>
        });
<span class="nc" id="L124">        jScrollPane2.setViewportView(lstAlimentos);</span>

<span class="nc" id="L126">        getContentPane().add(jScrollPane2);</span>
<span class="nc" id="L127">        jScrollPane2.setBounds(30, 90, 450, 170);</span>

<span class="nc" id="L129">        lstMisAlimentos.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);</span>
<span class="nc" id="L130">        jScrollPane3.setViewportView(lstMisAlimentos);</span>

<span class="nc" id="L132">        getContentPane().add(jScrollPane3);</span>
<span class="nc" id="L133">        jScrollPane3.setBounds(30, 340, 450, 190);</span>

<span class="nc" id="L135">        btnSalir.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 1, 13)); // NOI18N</span>
<span class="nc" id="L136">        btnSalir.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/imagenes/exit.png&quot;))); // NOI18N</span>
<span class="nc" id="L137">        btnSalir.setText(&quot;Salir&quot;);</span>
<span class="nc" id="L138">        btnSalir.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L140">                btnSalirActionPerformed(evt);</span>
<span class="nc" id="L141">            }</span>
        });
<span class="nc" id="L143">        getContentPane().add(btnSalir);</span>
<span class="nc" id="L144">        btnSalir.setBounds(30, 530, 130, 40);</span>

<span class="nc" id="L146">        btnAgregarAlimento.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 1, 13)); // NOI18N</span>
<span class="nc" id="L147">        btnAgregarAlimento.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/imagenes/arrow-angle-pointing-down.png&quot;))); // NOI18N</span>
<span class="nc" id="L148">        btnAgregarAlimento.setText(&quot;Agregar alimento&quot;);</span>
<span class="nc" id="L149">        btnAgregarAlimento.setEnabled(false);</span>
<span class="nc" id="L150">        btnAgregarAlimento.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L152">                btnAgregarAlimentoActionPerformed(evt);</span>
<span class="nc" id="L153">            }</span>
        });
<span class="nc" id="L155">        getContentPane().add(btnAgregarAlimento);</span>
<span class="nc" id="L156">        btnAgregarAlimento.setBounds(170, 270, 180, 50);</span>

<span class="nc" id="L158">        btnGuardar.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 1, 11)); // NOI18N</span>
<span class="nc" id="L159">        btnGuardar.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/imagenes/tack-save-button.png&quot;))); // NOI18N</span>
<span class="nc" id="L160">        btnGuardar.setText(&quot;Guardar&quot;);</span>
<span class="nc" id="L161">        btnGuardar.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L163">                btnGuardarActionPerformed(evt);</span>
<span class="nc" id="L164">            }</span>
        });
<span class="nc" id="L166">        getContentPane().add(btnGuardar);</span>
<span class="nc" id="L167">        btnGuardar.setBounds(360, 530, 120, 40);</span>

<span class="nc" id="L169">        dateChooser.setOpaque(false);</span>
<span class="nc" id="L170">        getContentPane().add(dateChooser);</span>
<span class="nc" id="L171">        dateChooser.setBounds(650, 70, 200, 30);</span>

<span class="nc" id="L173">        jLabel3.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 1, 13)); // NOI18N</span>
<span class="nc" id="L174">        jLabel3.setText(&quot;Seleccionar fecha:&quot;);</span>
<span class="nc" id="L175">        getContentPane().add(jLabel3);</span>
<span class="nc" id="L176">        jLabel3.setBounds(520, 70, 190, 30);</span>

<span class="nc" id="L178">        btnBuscar.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 1, 11)); // NOI18N</span>
<span class="nc" id="L179">        btnBuscar.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/imagenes/loupe.png&quot;))); // NOI18N</span>
<span class="nc" id="L180">        btnBuscar.setText(&quot;Buscar&quot;);</span>
<span class="nc" id="L181">        btnBuscar.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L183">                btnBuscarActionPerformed(evt);</span>
<span class="nc" id="L184">            }</span>
        });
<span class="nc" id="L186">        getContentPane().add(btnBuscar);</span>
<span class="nc" id="L187">        btnBuscar.setBounds(860, 70, 90, 28);</span>

<span class="nc" id="L189">        lblStatusIngerido.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 1, 13)); // NOI18N</span>
<span class="nc" id="L190">        lblStatusIngerido.setText(&quot;Ingreso de alimentos ingeridos del dia:&quot;);</span>
<span class="nc" id="L191">        getContentPane().add(lblStatusIngerido);</span>
<span class="nc" id="L192">        lblStatusIngerido.setBounds(40, 70, 430, 16);</span>

<span class="nc" id="L194">        jLabel4.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 1, 13)); // NOI18N</span>
<span class="nc" id="L195">        jLabel4.setText(&quot;Alimentos ingeridos:&quot;);</span>
<span class="nc" id="L196">        getContentPane().add(jLabel4);</span>
<span class="nc" id="L197">        jLabel4.setBounds(40, 320, 200, 16);</span>

<span class="nc" id="L199">        lblDia.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 1, 13)); // NOI18N</span>
<span class="nc" id="L200">        lblDia.setText(&quot;dd/MM/yyyy&quot;);</span>
<span class="nc" id="L201">        getContentPane().add(lblDia);</span>
<span class="nc" id="L202">        lblDia.setBounds(760, 120, 150, 16);</span>

<span class="nc" id="L204">        lblBackground.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/imagenes/wall_green.jpg&quot;))); // NOI18N</span>
<span class="nc" id="L205">        getContentPane().add(lblBackground);</span>
<span class="nc" id="L206">        lblBackground.setBounds(-280, -20, 1290, 690);</span>

<span class="nc" id="L208">        pack();</span>
<span class="nc" id="L209">    }// &lt;/editor-fold&gt;//GEN-END:initComponents</span>

    private void formWindowClosing(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowClosing

<span class="nc" id="L213">        this.dispose();</span>
<span class="nc" id="L214">        VentanaPanelUsuario ventana = new VentanaPanelUsuario(modelo);</span>
<span class="nc" id="L215">        ventana.setVisible(true);</span>
<span class="nc" id="L216">    }//GEN-LAST:event_formWindowClosing</span>

    private void btnAgregarAlimentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAgregarAlimentoActionPerformed
<span class="nc" id="L219">        Alimento alimento = (Alimento) this.lstAlimentos.getSelectedValue();</span>
<span class="nc bnc" id="L220" title="All 2 branches missed.">        if (!alimentosIngeridos.contains(alimento)) {</span>
<span class="nc" id="L221">            alimentosIngeridos.add(alimento);</span>
<span class="nc" id="L222">            this.lstMisAlimentos.setListData(alimentosIngeridos.toArray());</span>
        }
<span class="nc" id="L224">    }//GEN-LAST:event_btnAgregarAlimentoActionPerformed</span>

    private void btnGuardarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnGuardarActionPerformed
<span class="nc" id="L227">        int input = JOptionPane.showConfirmDialog(null, &quot;Esta seguro que desea registrar estos alimentos?\n&quot;</span>
                + &quot;Esta accion es irreversible&quot;, &quot;Confirmacion&quot;,
                JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
<span class="nc bnc" id="L230" title="All 2 branches missed.">        if (input == 0) {</span>
<span class="nc" id="L231">            usuarioActivo.agregarAlimentosIngeridos(alimentosIngeridos, fechaActual);</span>
<span class="nc" id="L232">            this.btnGuardar.setEnabled(false);</span>
<span class="nc" id="L233">            this.btnAgregarAlimento.setEnabled(false);</span>
<span class="nc" id="L234">            yaEstaRegistrado = true;</span>
        }
<span class="nc" id="L236">    }//GEN-LAST:event_btnGuardarActionPerformed</span>

    private void lstAlimentosValueChanged(javax.swing.event.ListSelectionEvent evt) {//GEN-FIRST:event_lstAlimentosValueChanged
<span class="nc bnc" id="L239" title="All 2 branches missed.">        if (!yaEstaRegistrado) {</span>
<span class="nc bnc" id="L240" title="All 2 branches missed.">            if (!evt.getValueIsAdjusting()) {</span>
<span class="nc bnc" id="L241" title="All 2 branches missed.">                if (this.lstAlimentos.getSelectedIndex() &gt;= 0) {</span>
<span class="nc" id="L242">                    this.btnAgregarAlimento.setEnabled(true);</span>
                } else {
<span class="nc" id="L244">                    this.btnAgregarAlimento.setEnabled(false);</span>
                }
            }
        }
<span class="nc" id="L248">    }//GEN-LAST:event_lstAlimentosValueChanged</span>

    private void btnBuscarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnBuscarActionPerformed
<span class="nc" id="L251">        Date fechaBuscada = this.dateChooser.getDate();</span>
<span class="nc" id="L252">        DateFormat date = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);</span>
<span class="nc" id="L253">        String fechaString = date.format(fechaBuscada);</span>
<span class="nc" id="L254">        this.lblDia.setText(fechaString);</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">        if (usuarioActivo.getAlimentosIngs().containsKey(fechaString)) {</span>
<span class="nc" id="L256">            ArrayList&lt;Alimento&gt; ingeridosHistorial = usuarioActivo.getAlimentosIngs().get(fechaString);</span>
<span class="nc" id="L257">            this.lstIngeridosHistorial.setListData(ingeridosHistorial.toArray());</span>
<span class="nc" id="L258">        } else {</span>
<span class="nc" id="L259">            String[] indefinido = {&quot;***NO HAY ALIMENTOS INGERIDOS EN ESTA FECHA.***&quot;};</span>
<span class="nc" id="L260">            this.lstIngeridosHistorial.setListData(indefinido);</span>
        }
<span class="nc" id="L262">    }//GEN-LAST:event_btnBuscarActionPerformed</span>

    private void btnSalirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSalirActionPerformed
<span class="nc" id="L265">        this.dispose();</span>
<span class="nc" id="L266">        VentanaPanelUsuario ventana = new VentanaPanelUsuario(modelo);</span>
<span class="nc" id="L267">        ventana.setVisible(true);</span>
<span class="nc" id="L268">    }//GEN-LAST:event_btnSalirActionPerformed</span>

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAgregarAlimento;
    private javax.swing.JButton btnBuscar;
    private javax.swing.JButton btnGuardar;
    private javax.swing.JButton btnSalir;
    private com.toedter.calendar.JDateChooser dateChooser;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JSeparator jSeparator3;
    private javax.swing.JLabel lblBackground;
    private javax.swing.JLabel lblDia;
    private javax.swing.JLabel lblHistorial;
    private javax.swing.JLabel lblStatusIngerido;
    private javax.swing.JList&lt;Object&gt; lstAlimentos;
    private javax.swing.JList&lt;Object&gt; lstIngeridosHistorial;
    private javax.swing.JList&lt;Object&gt; lstMisAlimentos;
    // End of variables declaration//GEN-END:variables
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>